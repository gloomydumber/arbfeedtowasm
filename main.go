package main

import (
	"arbfeedtowasm/feedtypes"
	"arbfeedtowasm/operation"
	"arbfeedtowasm/utils"
)

func main() {
	initialData := `{"sequenceNumber":241801449,"message":{"message":{"header":{"kind":3,"sender":"0xa4b000000000000000000073657175656e636572","blockNumber":20969771,"timestamp":1728980884,"requestId":null,"baseFeeL1":null},"l2Msg":"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"},"delayedMessagesRead":1719783}}`
	lastTimestamp := uint64(1728980884)

	if utils.IsJSObject(initialData) {
		initialData = utils.ConvertToJSON(initialData)
	}

	var msg feedtypes.IncomingMessage = utils.ParseIncomingMessage(initialData)

	txns := operation.ParseL2TransactionsWithStartTx(msg, lastTimestamp)

	utils.PrintTransactionsLength(txns)
	utils.PrintTransaction(txns[1]) // txns[0] was generated by AppendStartTransaction().
	utils.PrintTransaction(txns[2])
	utils.PrintTransaction(txns[3])
	utils.PrintTransaction(txns[4])
	utils.PrintTransaction(txns[5])
	utils.PrintTransaction(txns[6])
	utils.PrintTransactionsRoot(txns)
}
